# 西羊石AI微信插件 | WeChat Node for n8n

![NPM Version](https://img.shields.io/npm/v/n8n-nodes-weixin-wechat?style=flat-square&logo=npm)
![NPM Downloads](https://img.shields.io/npm/dt/n8n-nodes-weixin-wechat?style=flat-square&logo=npm)
![License](https://img.shields.io/npm/l/n8n-nodes-weixin-wechat?style=flat-square)

**让你的N8N支持微信消息发送！** 📱✨

> ✨ **v1.2.13新版**：彻底修复端口问题！个人微信发送功能现在可以正常使用，不再报错“连接被拒绝”！

---

## 🎯 你想用微信做什么？

### 🙋‍♂️ 真实个人微信发送 (推荐)
**适合：需要发送到个人联系人、工作群、朋友群**
- ✅ 真实微信控制，不会被限制  
- ✅ 发送给任何联系人/群聊
- ✅ 支持文本、图片、文件等
- ✅ 批量发送，智能延迟
- 🎯 **[3分钟快速开始 →](#-个人微信3分钟快速开始)**

### 🏢 企业微信群机器人
**适合：只需要发送到企业微信工作群**
- ✅ 无需额外部署，配置即用
- ✅ 支持文本和Markdown消息
- ✅ 官方API，稳定可靠
- 🎯 **[1分钟快速开始 →](#-企业微信1分钟快速开始)**

---

## 🚀 个人微信3分钟快速开始

### 第1步：安装插件 (30秒)
1. N8N → **设置** → **社区节点** → **安装**
2. 输入：`n8n-nodes-weixin-wechat`
3. 等待安装完成

### 第2步：获取API密钥 (30秒)
1. 关注微信公众号：**"西羊石AI视频"**
2. 发送：**"API"**
3. 复制收到的密钥

### 第3步：下载PC服务 (2分钟)
1. 访问：https://github.com/Standed/n8n-nodes-weixin-wechat
2. 下载到Windows电脑，进入 `personal-wechat-service` 目录
3. **双击运行**：`一键启动.bat`
4. 如提示缺少环境，会自动打开下载页面

### 第4步：配置N8N
1. 新建凭据 → **西羊石AI微信插件 API**
2. **API Key**：粘贴第2步获取的密钥
3. **个人微信服务地址**：`http://localhost:3000`

### 🎉 开始使用！
- 工作流中添加 **西羊石AI微信插件**
- 选择 **个人微信自动化**
- 发送到 **联系人**、**群聊** 或 **文件传输助手**

---

## 🏢 企业微信1分钟快速开始

### 第1步：安装插件 (30秒)
同个人微信第1步

### 第2步：获取API密钥 (30秒)
同个人微信第2步

### 第3步：获取企业微信Webhook
1. 企业微信群 → **群设置** → **机器人** → **添加机器人**
2. 复制生成的Webhook地址

### 第4步：配置使用
1. N8N工作流中添加 **西羊石AI微信插件**
2. 选择 **企业微信机器人**
3. 粘贴Webhook地址，发送消息测试

---

## 📋 功能对比

| 功能特性 | 🙋‍♂️ 个人微信 | 🏢 企业微信 |
|---------|:----------:|:----------:|
| 发送对象 | 任何联系人/群聊 | 企业微信群 |
| 消息类型 | 文本/图片/文件等 | 文本/Markdown |
| 部署要求 | 需PC服务 | 无需部署 |
| 被限制风险 | 极低(真实微信) | 无 |
| 功能丰富度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 使用难度 | ⭐⭐⭐ | ⭐ |

---

## 🔧 高级配置

### Docker用户
**个人微信服务地址**：`http://host.docker.internal:3000`

### 云端N8N用户  
**个人微信服务地址**：`http://您的PC公网IP:3000`
> 需要开放防火墙3000端口

### 批量发送设置
- **发送间隔**：建议3-5秒（避免限制）
- **随机延迟**：增加真实性
- **失败重试**：自动重试机制

---

## 🆘 遇到问题？

### 安装相关
❓ **插件安装失败？**
- 重启N8N后重新安装
- 检查N8N版本是否>=0.160.0

❓ **凭据配置错误？**  
- API Key：确保从公众号正确获取
- 服务地址：检查PC服务是否正常运行

### 个人微信相关
❓ **PC服务启动失败？**
- 检查Python和Node.js环境
- 查看 `personal-wechat-service/新手指南.md`

❓ **微信发送失败？**
- 确保PC微信已登录
- 联系人名称要完全匹配

### 企业微信相关
❓ **Webhook无效？**
- 重新在企业微信群中生成
- 检查URL格式是否正确

---

## 📞 获取帮助

- 🏠 **官网**：https://xysaiai.cn/
- 📱 **公众号**：西羊石AI视频
- 💬 **技术支持**：公众号发送"帮助"
- 🐛 **问题反馈**：[GitHub Issues](https://github.com/Standed/n8n-nodes-weixin-wechat/issues)

---

## 📝 更新日志

### v1.2.13 (最新)
- 🔥 **关键修复**：修复个人微信发送“连接被拒绝”问题，节点默认端口从3001改为3000
- 🔌 **端口统一**：所有组件(节点/credential/服务/文档)统一使用3000端口
- 📝 **JSON解析修复**：移除Python日志stdout输出，解决“不是有效的JSON”错误  
- 🎆 **功能正常**：个人微信发送现在可以正常使用了！

### v1.2.12
- 🔧 **修复核心bug**：personal-wechat-service端口从3001改为3000，与credential配置保持一致
- 🛠️ **改进启动脚本**：修复中文乱码显示，增强错误处理和调试信息
- 📝 **优化用户体验**：显示实际服务端口和健康检查地址
- 🌐 **双语支持**：保留中文版一键启动.bat和英文版start-english.bat

### v1.2.11
- 🔧 **修复凭证端口问题**：默认端口从3001改为3000
- 🐳 解决Docker环境n8n-workflow依赖问题
- ✅ 优化TypeScript构建流程
- 📋 同步更新README.md端口配置
- 🗂️ 清理项目冗余文件，减小包体积

### v1.2.6
- 🎉 **重大体验升级**：全新用户引导界面
- 🙋‍♂️ 主推个人微信功能，使用面更广
- ✅ 优化凭证配置，解决API Key混淆问题  
- 🚀 新增一键部署脚本，3分钟上手
- 📖 重构文档，按需求场景分流引导
- 🛠️ 优化节点界面，清晰展示功能特点

### v1.2.5
- 🐛 **重要修复**：解决N8N安装时的EACCES权限错误
- ✅ 优化包体积：从44.1kB减少到29.7kB
- ✅ 提升安装成功率和稳定性
- 🔧 完善构建流程和文件管理

### v1.2.4
- 🐛 尝试修复权限问题（部分解决）

### v1.2.3
- ✅ 新增真实个人微信自动化（基于wxauto）
- ✅ 企业微信支持Markdown消息
- ✅ 固定端口凭证验证
- ✅ 完善跨平台部署支持

---

## 📄 开源协议

MIT License - 详见 [LICENSE](LICENSE) 文件

---

<div align="center">

**⭐ 觉得好用？给个Star支持一下！**

**🌟 让你的N8N工作流更智能！**

Made with ❤️ by [西羊石AI](https://xysaiai.cn)

</div>