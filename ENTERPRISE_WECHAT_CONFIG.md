# 企业微信完整配置指南

## 当前错误解决

你遇到的错误：`not allow to access from your ip`

**解决步骤**：

### 1. 配置可信域名

1. 登录企业微信管理后台: https://work.weixin.qq.com/
2. 进入 **应用管理** > 你的应用
3. 在应用配置中找到 **网页授权及JS-SDK** 或 **可信域名**
4. 添加可信域名，可以尝试：
   - `localhost` (本地开发)
   - `127.0.0.1`
   - 你的服务器域名 (如果有)

### 2. 设置接收消息服务器URL (可选)

如果需要接收消息，配置：
- **URL**: `http://你的域名:3000/wechat/receive`
- **Token**: 自定义token
- **EncodingAESKey**: 企业微信生成

### 3. 配置可信IP

完成域名配置后，再配置IP白名单：
- 添加IP: `116.30.133.38` (当前请求IP)
- 或添加: `0.0.0.0/0` (所有IP，仅测试用)

### 4. 应用权限检查

确保应用有以下权限：
- 发送消息到企业微信
- 通讯录基本信息读取权限

## 简化配置建议

如果配置复杂，建议：

1. **继续使用Server酱** - 已经工作正常
2. **或者创建新的企业微信应用** - 简化配置
3. **使用企业微信机器人** - webhook方式更简单

## 企业微信机器人方案

作为替代，我可以为你创建企业微信群机器人功能：

1. 在企业微信群中添加机器人
2. 获取webhook URL
3. 直接发送，无需复杂配置

需要我实现机器人方案吗？